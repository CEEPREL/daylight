"use strict";exports.id=46,exports.ids=[46],exports.modules={11543:(e,r,t)=>{t.d(r,{cn:()=>d,rk:()=>s}),t(60687);var i=t(49384),a=t(82348);function d(...e){return(0,a.QP)((0,i.$)(e))}function s(e,r={includeFullEmail:!1}){return e.firstName&&e.lastName?`${e.firstName} ${e.lastName} ${r.includeFullEmail?`<${e.email}>`:""}`:e.email}},13964:(e,r,t)=>{t.d(r,{A:()=>i});let i=(0,t(62688).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},24934:(e,r,t)=>{t.d(r,{$:()=>o});var i=t(60687),a=t(8730),d=t(24224);t(43210);var s=t(11543);let n=(0,d.F)("inline-flex shrink-0 items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:pointer-events-none disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 gap-1.5 rounded-md px-3 text-xs has-[>svg]:px-2.5",lg:"h-8 rounded-md px-2 has-[>svg]:px-2 sm:h-10",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o({className:e,variant:r,size:t,asChild:d=!1,...o}){let l=d?a.DX:"button";return(0,i.jsx)(l,{"data-slot":"button",className:(0,s.cn)(n({variant:r,size:t,className:e})),...o})}},25436:(e,r,t)=>{t.r(r),t.d(r,{"60898d24b14ac512715f2dea04c5313a0efd33994a":()=>q,"60c00058479c7aebd52bc9972992d345ea47c5aef1":()=>C,"60e5eb8ce0d46bcf5a899dba690ef0944464632c07":()=>L});var i={};t.r(i),t.d(i,{emails:()=>w,emailsRelations:()=>z,folders:()=>_,foldersRelations:()=>F,threadFolders:()=>N,threadFoldersRelations:()=>S,threads:()=>j,threadsRelations:()=>R,userFolders:()=>E,userFoldersRelations:()=>D,users:()=>I,usersRelations:()=>k});var a=t(91199);t(42087);var d=t(41220),s=t(7944),n=t(90141),o=t(68567),l=t(41942),c=t.n(l),u=t(12141),f=t(36737),h=t(9581),m=t(15946),v=t(46134),p=t(43621),y=t(57318),g=t(91850),b=t(75680),x=t(60579);let I=(0,m.cJ)("users",{id:(0,v.vX)("id").primaryKey(),firstName:(0,p.yf)("first_name",{length:50}),lastName:(0,p.yf)("last_name",{length:50}),email:(0,p.yf)("email",{length:255}).notNull(),jobTitle:(0,p.yf)("job_title",{length:100}),company:(0,p.yf)("company",{length:100}),location:(0,p.yf)("location",{length:100}),twitter:(0,p.yf)("twitter",{length:100}),linkedin:(0,p.yf)("linkedin",{length:100}),github:(0,p.yf)("github",{length:100}),avatarUrl:(0,p.yf)("avatar_url",{length:255})},e=>({emailIndex:(0,y.GL)("email_idx").on(e.email)})),j=(0,m.cJ)("threads",{id:(0,v.vX)("id").primaryKey(),subject:(0,p.yf)("subject",{length:255}),lastActivityDate:(0,g.vE)("last_activity_date").defaultNow()}),w=(0,m.cJ)("emails",{id:(0,v.vX)("id").primaryKey(),threadId:(0,b.nd)("thread_id").references(()=>j.id),senderId:(0,b.nd)("sender_id").references(()=>I.id),recipientId:(0,b.nd)("recipient_id").references(()=>I.id),subject:(0,p.yf)("subject",{length:255}),body:(0,x.Qq)("body"),sentDate:(0,g.vE)("sent_date").defaultNow()},e=>({threadIdIndex:(0,y.Pe)("thread_id_idx").on(e.threadId),senderIdIndex:(0,y.Pe)("sender_id_idx").on(e.senderId),recipientIdIndex:(0,y.Pe)("recipient_id_idx").on(e.recipientId),sentDateIndex:(0,y.Pe)("sent_date_idx").on(e.sentDate)})),_=(0,m.cJ)("folders",{id:(0,v.vX)("id").primaryKey(),name:(0,p.yf)("name",{length:50}).notNull()}),E=(0,m.cJ)("user_folders",{id:(0,v.vX)("id").primaryKey(),userId:(0,b.nd)("user_id").references(()=>I.id),folderId:(0,b.nd)("folder_id").references(()=>_.id)}),N=(0,m.cJ)("thread_folders",{id:(0,v.vX)("id").primaryKey(),threadId:(0,b.nd)("thread_id").references(()=>j.id),folderId:(0,b.nd)("folder_id").references(()=>_.id)}),k=(0,h.K1)(I,({many:e})=>({sentEmails:e(w,{relationName:"sender"}),receivedEmails:e(w,{relationName:"recipient"}),userFolders:e(E)})),R=(0,h.K1)(j,({many:e})=>({emails:e(w),threadFolders:e(N)})),z=(0,h.K1)(w,({one:e})=>({thread:e(j,{fields:[w.threadId],references:[j.id]}),sender:e(I,{fields:[w.senderId],references:[I.id],relationName:"sender"}),recipient:e(I,{fields:[w.recipientId],references:[I.id],relationName:"recipient"})})),F=(0,h.K1)(_,({many:e})=>({userFolders:e(E),threadFolders:e(N)})),D=(0,h.K1)(E,({one:e})=>({user:e(I,{fields:[E.userId],references:[I.id]}),folder:e(_,{fields:[E.folderId],references:[_.id]})})),S=(0,h.K1)(N,({one:e})=>({thread:e(j,{fields:[N.threadId],references:[j.id]}),folder:e(_,{fields:[N.folderId],references:[_.id]})}));if(c().config(),!process.env.POSTGRES_URL)throw Error("POSTGRES_URL environment variable is not set");let A=(0,f.A)(process.env.POSTGRES_URL),T=(0,u.f)(A,{schema:i});var P=t(33331);let K=o.z.object({subject:o.z.string().min(1,"Subject is required"),body:o.z.string().min(1,"Body is required"),recipientEmail:o.z.string().email("Invalid email address")});async function L(e,r){let t;let i={subject:r.get("subject"),body:r.get("body"),recipientEmail:r.get("recipientEmail")};if("production"===process.env.VERCEL_ENV)return{error:"Only works on localhost for now",previous:i};try{let{subject:e,body:i,recipientEmail:a}=K.parse({subject:r.get("subject"),body:r.get("body"),recipientEmail:r.get("recipientEmail")}),[s]=await T.select().from(I).where((0,d.eq)(I.email,a));s||([s]=await T.insert(I).values({email:a}).returning()),t=(await T.insert(j).values({subject:e,lastActivityDate:new Date}).returning())[0],await T.insert(w).values({threadId:t.id,senderId:1,recipientId:s.id,subject:e,body:i,sentDate:new Date});let[n]=await T.select().from(_).where((0,d.eq)(_.name,"Sent"));await T.insert(N).values({threadId:t.id,folderId:n.id})}catch(e){if(e instanceof o.z.ZodError)return{error:e.errors[0].message,previous:i};return{error:"Failed to send email. Please try again.",previous:i}}(0,s.revalidatePath)("/","layout"),(0,n.redirect)(`/f/sent/${t.id}`)}async function q(e,r){if("production"===process.env.VERCEL_ENV)return{error:"Only works on localhost for now"};let t=r.get("threadId");if(!t||"string"!=typeof t)return{error:"Invalid thread ID",success:!1};try{let e=await T.query.folders.findFirst({where:(0,d.eq)(_.name,"Archive")});if(!e)return{error:"Done folder not found",success:!1};let r=parseInt(t,10);return await T.delete(N).where((0,d.eq)(N.threadId,r)),await T.insert(N).values({threadId:r,folderId:e.id}),(0,s.revalidatePath)("/f/[name]"),(0,s.revalidatePath)("/f/[name]/[id]"),{success:!0,error:null}}catch(e){return console.error("Failed to move thread to Done:",e),{success:!1,error:"Failed to move thread to Done"}}}async function C(e,r){if("production"===process.env.VERCEL_ENV)return{error:"Only works on localhost for now"};let t=r.get("threadId");if(!t||"string"!=typeof t)return{error:"Invalid thread ID",success:!1};try{let e=await T.query.folders.findFirst({where:(0,d.eq)(_.name,"Trash")});if(!e)return{error:"Trash folder not found",success:!1};let r=parseInt(t,10);return await T.delete(N).where((0,d.eq)(N.threadId,r)),await T.insert(N).values({threadId:r,folderId:e.id}),(0,s.revalidatePath)("/f/[name]"),(0,s.revalidatePath)("/f/[name]/[id]"),{success:!0,error:null}}catch(e){return console.error("Failed to move thread to Trash:",e),{success:!1,error:"Failed to move thread to Trash"}}}(0,P.D)([L,q,C]),(0,a.A)(L,"60e5eb8ce0d46bcf5a899dba690ef0944464632c07",null),(0,a.A)(q,"60898d24b14ac512715f2dea04c5313a0efd33994a",null),(0,a.A)(C,"60c00058479c7aebd52bc9972992d345ea47c5aef1",null)},46055:(e,r,t)=>{t.r(r),t.d(r,{default:()=>a});var i=t(31658);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,i.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},80189:(e,r,t)=>{t.d(r,{Bc:()=>s,ZI:()=>l,k$:()=>o,m_:()=>n});var i=t(60687),a=t(98424);t(43210);var d=t(11543);function s({delayDuration:e=0,...r}){return(0,i.jsx)(a.Kq,{"data-slot":"tooltip-provider",delayDuration:e,...r})}function n({...e}){return(0,i.jsx)(s,{children:(0,i.jsx)(a.bL,{"data-slot":"tooltip",...e})})}function o({...e}){return(0,i.jsx)(a.l9,{"data-slot":"tooltip-trigger",...e})}function l({className:e,sideOffset:r=0,children:t,...s}){return(0,i.jsx)(a.ZL,{children:(0,i.jsxs)(a.UC,{"data-slot":"tooltip-content",sideOffset:r,className:(0,d.cn)("z-50 w-fit rounded-md bg-primary px-3 py-1.5 text-xs text-balance text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95",e),...s,children:[t,(0,i.jsx)(a.i3,{className:"z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px] bg-primary fill-primary"})]})})}},96752:(e,r,t)=>{t.d(r,{ThreadActions:()=>h});var i=t(60687),a=t(80189),d=t(6475);let s=(0,d.createServerReference)("60898d24b14ac512715f2dea04c5313a0efd33994a",d.callServer,void 0,d.findSourceMapURL,"moveThreadToDone"),n=(0,d.createServerReference)("60c00058479c7aebd52bc9972992d345ea47c5aef1",d.callServer,void 0,d.findSourceMapURL,"moveThreadToTrash");var o=t(13964),l=t(62688);let c=(0,l.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),u=(0,l.A)("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);var f=t(43210);function h({threadId:e}){let r={error:null,success:!1},[t,d,l]=(0,f.useActionState)(s,r),[h,m,v]=(0,f.useActionState)(n,r),p="production"===process.env.NEXT_PUBLIC_VERCEL_ENV;return(0,i.jsx)(a.Bc,{children:(0,i.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,i.jsxs)(a.m_,{children:[(0,i.jsx)(a.k$,{asChild:!0,children:(0,i.jsxs)("form",{action:d,children:[(0,i.jsx)("input",{type:"hidden",name:"threadId",value:e}),(0,i.jsx)("button",{type:"submit",disabled:l||p,className:"flex h-6 w-6 cursor-pointer items-center justify-center rounded-full transition-colors hover:bg-gray-200 disabled:cursor-not-allowed disabled:opacity-50",children:(0,i.jsx)(o.A,{size:14,className:"text-gray-600"})})]})}),p&&(0,i.jsx)(a.ZI,{children:(0,i.jsx)("p",{children:"Marking as done is disabled in production"})})]}),(0,i.jsxs)(a.m_,{children:[(0,i.jsx)(a.k$,{asChild:!0,children:(0,i.jsx)("button",{disabled:!0,className:"flex h-6 w-6 cursor-pointer items-center justify-center rounded-full transition-colors hover:bg-gray-200 disabled:cursor-not-allowed disabled:opacity-50",children:(0,i.jsx)(c,{size:14,className:"text-gray-400"})})}),(0,i.jsx)(a.ZI,{children:(0,i.jsx)("p",{children:"This feature is not yet implemented"})})]}),(0,i.jsxs)(a.m_,{children:[(0,i.jsx)(a.k$,{asChild:!0,children:(0,i.jsxs)("form",{action:m,children:[(0,i.jsx)("input",{type:"hidden",name:"threadId",value:e}),(0,i.jsx)("button",{type:"submit",disabled:v||p,className:"flex h-6 w-6 cursor-pointer items-center justify-center rounded-full transition-colors hover:bg-gray-200 disabled:cursor-not-allowed disabled:opacity-50",children:(0,i.jsx)(u,{size:14,className:"text-gray-600"})})]})}),p&&(0,i.jsx)(a.ZI,{children:(0,i.jsx)("p",{children:"Moving to trash is disabled in production"})})]})]})})}}};
//# sourceMappingURL=46.js.map